<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<title>–ö–æ–ª–µ—Å–æ —Ñ–æ—Ä—Ç—É–Ω—ã üé°</title>
<style>
  body {
    background: linear-gradient(135deg, #6b42f4, #b07cff);
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    height: 100vh;
    margin: 0;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    color: white;
    user-select: none;
  }
  h1 {
    margin-bottom: 20px;
    text-shadow: 0 0 10px rgba(0,0,0,0.6);
  }
  #wheel-container {
    position: relative;
    width: 600px;
    height: 600px;
  }
  #wheel {
    width: 600px;
    height: 600px;
    border-radius: 50%;
    border: 10px solid #fff;
    box-shadow: 0 0 40px rgba(255,255,255,0.6);
    transition: transform 4s cubic-bezier(0.33, 1, 0.68, 1);
  }
  /* –°—Ç—Ä–µ–ª–∫–∞ —Å–≤–µ—Ä—Ö—É */
  #pointer {
    position: absolute;
    top: -30px;
    left: 50%;
    transform: translateX(-50%);
    width: 0; 
    height: 0; 
    border-left: 30px solid transparent;
    border-right: 30px solid transparent;
    border-bottom: 40px solid #fff;
    filter: drop-shadow(0 0 6px rgba(0,0,0,0.3));
    z-index: 10;
  }
  button {
    margin-top: 30px;
    background: #fff;
    color: #6b42f4;
    font-weight: 700;
    font-size: 22px;
    border: none;
    padding: 18px 40px;
    border-radius: 14px;
    cursor: pointer;
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    transition: background 0.3s ease;
  }
  button:hover:not(:disabled) {
    background: #dcd6ff;
  }
  button:disabled {
    background: #bbb;
    cursor: not-allowed;
  }
  #result {
    margin-top: 25px;
    font-size: 26px;
    font-weight: 700;
    text-shadow: 0 0 8px rgba(0,0,0,0.4);
    min-height: 32px;
  }
  #balance {
    margin-top: 15px;
    font-size: 20px;
    font-weight: 600;
    color: #e0d9ff;
    text-shadow: 0 0 5px rgba(0,0,0,0.3);
  }
  /* –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –≤—ã–∏–≥—Ä—ã—à–Ω–æ–≥–æ —Å–µ–∫—Ç–æ—Ä–∞ */
  #highlightCanvas {
    position: absolute;
    top: 0; left: 0;
    pointer-events: none;
  }
</style>
</head>
<body>

<h1>–ö–æ–ª–µ—Å–æ —Ñ–æ—Ä—Ç—É–Ω—ã üé°</h1>

<div id="wheel-container">
  <canvas id="wheel" width="600" height="600"></canvas>
  <canvas id="highlightCanvas" width="600" height="600"></canvas>
  <div id="pointer"></div>
</div>

<button id="spinBtn">–ö—Ä—É—Ç–∏—Ç—å!</button>
<div id="result"></div>
<div id="balance">–ë–∞–ª–∞–Ω—Å: 1000 üí∞</div>

<script>
  const wheelCanvas = document.getElementById('wheel');
  const wheelCtx = wheelCanvas.getContext('2d');
  const highlightCanvas = document.getElementById('highlightCanvas');
  const highlightCtx = highlightCanvas.getContext('2d');
  const spinBtn = document.getElementById('spinBtn');
  const resultDiv = document.getElementById('result');
  const balanceDiv = document.getElementById('balance');

  // –ü—Ä–∏–∑—ã
  let prizes = [
    {text: "100 üí∞", color: "#ff7f50", value: 100},
    {text: "200 üí∞", color: "#f5a623", value: 200},
    {text: "300 üí∞", color: "#f8e71c", value: 300},
    {text: "500 üí∞", color: "#7ed321", value: 500},
    {text: "1000 üí∞", color: "#50e3c2", value: 1000},
    {text: "2x —à–∞–Ω—Å", color: "#4a90e2", value: 0, multiplier: 2},
    {text: "–ë–æ–Ω—É—Å", color: "#bd10e0", value: 0},
    {text: "–ü—Ä–∏–∑ —Å—é—Ä–ø—Ä–∏–∑", color: "#d0021b", value: 0},
  ];

  let balance = 1000;

  const wheelRadius = 300;
  const centerX = wheelCanvas.width / 2;
  const centerY = wheelCanvas.height / 2;
  const segmentAngle = (2 * Math.PI) / prizes.length;

  function drawWheel() {
    wheelCtx.clearRect(0, 0, wheelCanvas.width, wheelCanvas.height);
    for(let i = 0; i < prizes.length; i++) {
      wheelCtx.beginPath();
      wheelCtx.moveTo(centerX, centerY);
      wheelCtx.arc(centerX, centerY, wheelRadius, i * segmentAngle, (i + 1) * segmentAngle);
      wheelCtx.fillStyle = prizes[i].color;
      wheelCtx.fill();
      wheelCtx.strokeStyle = '#fff';
      wheelCtx.lineWidth = 3;
      wheelCtx.stroke();

      // –¢–µ–∫—Å—Ç
      wheelCtx.save();
      wheelCtx.translate(centerX, centerY);
      wheelCtx.rotate(i * segmentAngle + segmentAngle / 2);
      wheelCtx.textAlign = "right";
      wheelCtx.fillStyle = "#fff";
      wheelCtx.font = "bold 24px Arial";
      wheelCtx.fillText(prizes[i].text, wheelRadius - 40, 10);
      wheelCtx.restore();
    }
  }

  function highlightSector(index) {
    highlightCtx.clearRect(0, 0, highlightCanvas.width, highlightCanvas.height);
    highlightCtx.beginPath();
    highlightCtx.moveTo(centerX, centerY);
    highlightCtx.arc(centerX, centerY, wheelRadius, index * segmentAngle, (index + 1) * segmentAngle);
    highlightCtx.closePath();
    highlightCtx.fillStyle = "rgba(255, 255, 255, 0.35)";
    highlightCtx.shadowColor = "yellow";
    highlightCtx.shadowBlur = 25;
    highlightCtx.fill();
  }

  function clearHighlight() {
    highlightCtx.clearRect(0, 0, highlightCanvas.width, highlightCanvas.height);
  }

  drawWheel();

  let currentAngle = 0;
  let isSpinning = false;

  spinBtn.addEventListener('click', () => {
    if (isSpinning) return;
    if (balance < 100) {
      alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–∞–ª–∞–Ω—Å–∞ –¥–ª—è —Å—Ç–∞–≤–∫–∏ (100 üí∞).");
      return;
    }
    isSpinning = true;
    spinBtn.disabled = true;
    resultDiv.textContent = '';
    clearHighlight();

    balance -= 100;
    updateBalance();

    const spins = Math.floor(Math.random() * 3) + 4;
    const stopAngle = Math.random() * 2 * Math.PI;
    const targetAngle = spins * 2 * Math.PI + stopAngle;
    const duration = 6000;
    const start = performance.now();

    function animate(time) {
      let elapsed = time - start;
      if (elapsed > duration) elapsed = duration;

      const t = elapsed / duration;
      const easedT = 1 - Math.pow(1 - t, 3);
      currentAngle = easedT * targetAngle;
      wheelCanvas.style.transform = `rotate(${-currentAngle}rad)`;
      highlightCanvas.style.transform = `rotate(${-currentAngle}rad)`;

      if (elapsed < duration) {
        requestAnimationFrame(animate);
      } else {
        const normalizedAngle = currentAngle % (2 * Math.PI);
        const index = prizes.length - 1 - Math.floor(normalizedAngle / segmentAngle);
        showResult(index);
        highlightSector(index);
        isSpinning = false;
        spinBtn.disabled = false;
      }
    }
    requestAnimationFrame(animate);
  });

  function showResult(index) {
    const prize = prizes[index];
    let winText = '';
    if (prize.value > 0) {
      balance += prize.value;
      winText = `–í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ ${prize.text}!`;
    } else if (prize.multiplier) {
      winText = `–í–∞–º –≤—ã–ø–∞–ª —à–∞–Ω—Å —É–≤–µ–ª–∏—á–∏—Ç—å –≤—ã–∏–≥—Ä—ã—à –≤ ${prize.multiplier} —Ä–∞–∑–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–π –∏–≥—Ä–µ!`;
      // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –º—É–ª—å—Ç–∏–ø–ª–∏–∫–∞—Ç–æ—Ä–∞ (–¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –Ω–µ —Ä–µ–∞–ª–∏–∑—É–µ–º)
    } else {
      winText = `–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –ü–æ–ª—É—á–∏—Ç–µ –±–æ–Ω—É—Å: ${prize.text}`;
    }
    updateBalance();
    resultDiv.textContent = winText;
  }

  function updateBalance() {
    balanceDiv.textContent = `–ë–∞–ª–∞–Ω—Å: ${balance} üí∞`;
  }
</script>

</body>
</html>